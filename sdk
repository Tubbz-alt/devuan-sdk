#!/usr/bin/env zsh

# reqs: elinks, curl, gnupg2

zmodload zsh/system
zmodload zsh/regex

source zlibs/helpers
source zlibs/fetch

source config

# global variables
typeset -h sdk_path cmd_name source_url
typeset -h pkg_name pkg_ver pkg_dsc pkg_dest_dir
typeset -h pkg_dsc_file pkg_orig_file pkg_debian_file
typeset -A hash_map

# arg check
cmd_name="$1"
[[ "$cmd_name" = "" ]] && {
    print "usage: source sdk package-name [version]"
    return 1
}

# we assume source sdk is always run from the source dir
sdk_path=`pwd`

[[ "$cmd_name" = "init" ]] && {
    # initialization
    init-repos
    init-keyring
    return $?
}

pkg_name=${cmd_name}

rprompt

TRAPZERR() { 
    print "Error reported, canceling operation."
    return 1
}

# where to download packages
mkdir -p sources

print
print "Package loaded: $cmd_name"
print

